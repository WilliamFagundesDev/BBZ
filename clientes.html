<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clientes Cadastrados - Admin</title>
    <link rel="icon" href="./imgs/icon.png" type="image/png">
    <!-- Header Unificado -->
    <script src="Header.js" defer></script>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #374151;
            /* Adiciona padding-top para o conteúdo não ficar atrás do header fixo */
            padding-top: 80px;
        }
    </style>
</head>
<body class="antialiased">

    <main class="p-4 sm:p-6 lg:p-8">
        <div class="max-w-7xl mx-auto">
            <!-- Cabeçalho da Página -->
            <div class="flex justify-between items-center mb-8 flex-wrap gap-4">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800">Clientes Cadastrados</h1>
                    <p class="text-gray-500 mt-1">Visualize e gerencie os clientes da sua loja.</p>
                </div>
                <a href="cadastrobbz.html" class="bg-gray-200 text-gray-800 font-semibold px-5 py-2.5 rounded-lg shadow-sm hover:bg-gray-300 transition-colors duration-200 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                    <span>Voltar ao Painel</span>
                </a>
            </div>

            <!-- Seção de Clientes -->
            <div class="bg-white rounded-xl shadow-md p-6">
                <div id="loading-message" class="text-center py-10">
                    <p class="text-lg text-gray-500">Carregando clientes...</p>
                </div>
                <div id="no-clients-message" class="hidden text-center py-10">
                    <p class="text-lg text-gray-500">Nenhum cliente cadastrado ainda.</p>
                </div>
                <!-- Tabela para Desktop -->
                <div class="hidden md:block overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome Completo</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Telefone</th>
                            </tr>
                        </thead>
                        <tbody id="clients-table-body" class="bg-white divide-y divide-gray-200">
                            <!-- Linhas da tabela serão inseridas aqui -->
                        </tbody>
                    </table>
                </div>
                <!-- Cards para Mobile -->
                <div id="clients-card-container" class="grid grid-cols-1 sm:grid-cols-2 gap-6 md:hidden">
                    <!-- Cards de cliente serão inseridos aqui -->
                </div>
            </div>
        </div>
    </main>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

    <script>
        // --- Configurações ---
        const firebaseConfig = {
            apiKey: "AIzaSyBk1cV2SQEhEToTdDxqDBTYOHjyogHaOAE",
            authDomain: "bbz-imports.firebaseapp.com",
            databaseURL: "https://bbz-imports-default-rtdb.firebaseio.com",
            projectId: "bbz-imports",
            storageBucket: "bbz-imports.appspot.com",
            messagingSenderId: "184315339952",
            appId: "1:184315339952:web:d8bab53b3a7fae2e6e4775",
            measurementId: "G-QBNJP7HHQB"
        };

        // --- Inicialização ---
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth();

        // --- Elementos do DOM ---
        const loadingMessage = document.getElementById('loading-message');
        const noClientsMessage = document.getElementById('no-clients-message');
        const clientsTableBody = document.getElementById('clients-table-body');
        const clientsCardContainer = document.getElementById('clients-card-container');

        // --- Autenticação ---
        auth.onAuthStateChanged(user => {
            if (!user || user.email !== 'importsbbz@gmail.com') {
                window.location.href = 'login.html';
            } else {
                loadClients();
            }
        });

        // --- Carregamento de Dados ---
        function loadClients() {
            const clientsRef = database.ref('clientes');
            clientsRef.on('value', (snapshot) => {
                loadingMessage.style.display = 'none';
                clientsTableBody.innerHTML = '';
                clientsCardContainer.innerHTML = '';

                const clients = snapshot.val();
                if (clients) {
                    noClientsMessage.classList.add('hidden');
                    Object.values(clients).forEach(client => {
                        const fullName = `${client.nome || ''} ${client.sobrenome || ''}`.trim();

                        // Cria linha da tabela para desktop
                        const tableRow = `
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${fullName}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${client.email || 'N/A'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${client.telefone || 'N/A'}</td>
                            </tr>
                        `;
                        clientsTableBody.innerHTML += tableRow;

                        // Cria card para mobile
                        const card = `
                            <div class="bg-gray-50 p-4 rounded-lg shadow-sm border">
                                <h3 class="font-bold text-gray-900">${fullName}</h3>
                                <p class="text-sm text-gray-600 mt-1">${client.email || 'N/A'}</p>
                                <p class="text-sm text-gray-600 mt-1">${client.telefone || 'N/A'}</p>
                            </div>
                        `;
                        clientsCardContainer.innerHTML += card;
                    });
                } else {
                    noClientsMessage.classList.remove('hidden');
                }
            }, (error) => {
                console.error("Erro ao carregar clientes:", error);
                loadingMessage.textContent = 'Falha ao carregar clientes.';
            });
        }
    </script>
</body>
</html>
